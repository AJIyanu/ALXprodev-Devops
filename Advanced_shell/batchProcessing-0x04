#!/bin/bash

declare -A POKEMON_URLS
POKEMON_URLS[bulbasaur]="https://pokeapi.co/api/v2/pokemon/1/"
POKEMON_URLS[ivysaur]="https://pokeapi.co/api/v2/pokemon/2/"
POKEMON_URLS[venusaur]="https://pokeapi.co/api/v2/pokemon/3/"
POKEMON_URLS[charmander]="https://pokeapi.co/api/v2/pokemon/4/"
POKEMON_URLS[charmeleon]="https://pokeapi.co/api/v2/pokemon/5/"

PIDS=()

echo "Starting background processes to fetch Pokémon data..."
echo "--------------------------------------------------------"

for POKEMON in "${!POKEMON_URLS[@]}"; do
  URL="${POKEMON_URLS[$POKEMON]}"
  OUTPUT_FILE="$POKEMON.json"

  
  curl -s -o "$OUTPUT_FILE" "$URL" >/dev/null 2>&1 &
  
  PIDS+=($!)
  echo "  - Started fetch for $POKEMON (PID: $!)"
done

echo ""
echo "All background jobs are now running."
echo "You can use the 'jobs' command to see their status:"
jobs

echo "--------------------------------------------------------"
echo "Waiting for all background processes to complete..."
echo "--------------------------------------------------------"

for PID in "${PIDS[@]}"; do
  wait "$PID"
  echo "  - Process $PID has completed."
done

echo ""
echo "All Pokémon data has been successfully fetched and saved."
echo "You can now list the generated JSON files:"
ls -1 *.json